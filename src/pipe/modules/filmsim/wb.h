#pragma once
// the rest of this header is autogenerated by the following script:
#if 0
#!/bin/bash

films=(
kodak_portra_400,
kodak_ultramax_400,
kodak_gold_200,
kodak_vision3_50d,
fujifilm_pro_400h,
fujifilm_xtra_400,
fujifilm_c200
)

papers=(
kodak_endura_premier,
kodak_ektacolor_edge,
kodak_supra_endura,
kodak_portra_endura,
fujifilm_crystal_archive_typeii
)

n_films=${#films[@]}
n_papers=${#papers[@]}
# ${films[0]}

cat << EOF > neutral.cfg
frames:1
fps:0
module:const:main:23.3783:290.7
module:filmsim:01:255.558:326.7
module:display:main:719.252:340.033
module:pick:01:510.405:124.7
module:i-lut:filmsim:21.3333:441
module:i-lut:spectem:20:580.333
connect:const:main:output:filmsim:01:input
connect:i-lut:filmsim:output:filmsim:01:filmsim
connect:i-lut:spectem:output:filmsim:01:spectra
connect:filmsim:01:output:display:main:input
connect:filmsim:01:output:pick:01:input
param:const:main:nspots:1
param:const:main:colour:0.184:0.184:0.184:1
param:const:main:mode:0
param:pick:01:nspots:1
param:pick:01:spots:0:1:0:1
param:pick:01:ref:0.1774128:0.184:0.1518184
param:pick:01:show:2
param:pick:01:grab:1
param:pick:01:freeze:0
param:i-lut:filmsim:filename:data/filmsim.lut
param:i-lut:spectem:filename:data/spectra-em.lut
EOF

echo "// ev paper, filter c, filter m, filter y" > results.txt
echo "const float wb[$n_films][$n_papers][4] = {" >> results.txt
f=0
for film in ${films[@]}
do
  p=0
  echo "{" >> results.txt
  for paper in ${papers[@]}
  do
    echo $film $paper $f $p

    vkdt fit -d none -g neutral.cfg \
      --param "filmsim:01:filter c" \
      --param "filmsim:01:filter m" \
      --param "filmsim:01:filter y" \
      --param "filmsim:01:ev paper" \
      --target "pick:01:de76" --nelder-mead \
      --config "param:filmsim:01:film:$f" "param:filmsim:01:paper:$p" > neutral-opt.cfg
    echo "{ //" $film $paper $f $p >> results.txt
    echo $(cat neutral-opt.cfg | grep -E '^param:filmsim:01:ev paper' | cut -d: -f5), >> results.txt
    echo $(cat neutral-opt.cfg | grep -E '^param:filmsim:01:filter c' | cut -d: -f5), >> results.txt
    echo $(cat neutral-opt.cfg | grep -E '^param:filmsim:01:filter m' | cut -d: -f5), >> results.txt
    echo $(cat neutral-opt.cfg | grep -E '^param:filmsim:01:filter y' | cut -d: -f5), >> results.txt
    echo "}," >> results.txt
    p=$((p+1))
  done
  echo "}," >> results.txt
  f=$((f+1))
done
echo "};" >> results.txt
rm neutral-opt.cfg
#endif

// ev paper, filter c, filter m, filter y
const float wb[7][5][4] = {
{
{ // kodak_portra_400, kodak_endura_premier, 0 0
0.205043,
0.413645,
0.409967,
0.479135,
},
{ // kodak_portra_400, kodak_ektacolor_edge, 0 1
0.204618,
0.252659,
0.283585,
0.716384,
},
{ // kodak_portra_400, kodak_supra_endura, 0 2
0.287875,
0.114998,
0.0697072,
0.866535,
},
{ // kodak_portra_400, kodak_portra_endura, 0 3
0.329913,
0.11865,
0.0644111,
0.883905,
},
{ // kodak_portra_400, fujifilm_crystal_archive_typeii 0 4
-0.238548,
0.523336,
0.408231,
0.880498,
},
},
{
{ // kodak_ultramax_400, kodak_endura_premier, 1 0
0.178293,
0.427824,
0.492744,
0.567468,
},
{ // kodak_ultramax_400, kodak_ektacolor_edge, 1 1
0.132546,
0.259908,
0.372616,
0.742814,
},
{ // kodak_ultramax_400, kodak_supra_endura, 1 2
0.418977,
0.15683,
0.407982,
0.895201,
},
{ // kodak_ultramax_400, kodak_portra_endura, 1 3
0.382688,
0.124052,
0.365998,
0.902266,
},
{ // kodak_ultramax_400, fujifilm_crystal_archive_typeii 1 4
-0.333751,
0.532548,
0.469324,
0.8985,
},
},
{
{ // kodak_gold_200, kodak_endura_premier, 2 0
-0.147575,
0.60699,
0.589967,
0.595717,
},
{ // kodak_gold_200, kodak_ektacolor_edge, 2 1
-0.180906,
0.495954,
0.496639,
0.739663,
},
{ // kodak_gold_200, kodak_supra_endura, 2 2
-0.0947274,
0.321886,
0.50331,
0.831386,
},
{ // kodak_gold_200, kodak_portra_endura, 2 3
-0.0863581,
0.310975,
0.483112,
0.84673,
},
{ // kodak_gold_200, fujifilm_crystal_archive_typeii 2 4
-0.663808,
0.692704,
0.564355,
0.913324,
},
},
{
{ // kodak_vision3_50d, kodak_endura_premier, 3 0
-0.781781,
0.80072,
0.801364,
0.814151,
},
{ // kodak_vision3_50d, kodak_ektacolor_edge, 3 1
-0.967974,
0.688854,
0.732167,
0.843536,
},
{ // kodak_vision3_50d, kodak_supra_endura, 3 2
-0.783107,
0.649645,
0.78188,
0.875473,
},
{ // kodak_vision3_50d, kodak_portra_endura, 3 3
-0.818508,
0.63335,
0.758871,
0.881692,
},
{ // kodak_vision3_50d, fujifilm_crystal_archive_typeii 3 4
-1.20997,
0.832807,
0.807018,
0.976238,
},
},
{
{ // fujifilm_pro_400h, kodak_endura_premier, 4 0
-0.474766,
0.815823,
0.830537,
0.826903,
},
{ // fujifilm_pro_400h, kodak_ektacolor_edge, 4 1
-0.726382,
0.703631,
0.758272,
0.849377,
},
{ // fujifilm_pro_400h, kodak_supra_endura, 4 2
-0.652038,
0.638233,
0.807659,
0.839443,
},
{ // fujifilm_pro_400h, kodak_portra_endura, 4 3
-0.64436,
0.631358,
0.795228,
0.852519,
},
{ // fujifilm_pro_400h, fujifilm_crystal_archive_typeii 4 4
-1.15642,
0.824765,
0.798125,
0.970695,
},
},
{
{ // fujifilm_xtra_400, kodak_endura_premier, 5 0
-0.601565,
0.721736,
0.805924,
0.845261,
},
{ // fujifilm_xtra_400, kodak_ektacolor_edge, 5 1
-0.987176,
0.515077,
0.699085,
0.850137,
},
{ // fujifilm_xtra_400, kodak_supra_endura, 5 2
-0.647298,
0.490639,
0.847543,
0.884286,
},
{ // fujifilm_xtra_400, kodak_portra_endura, 5 3
-0.68492,
0.466048,
0.82731,
0.889976,
},
{ // fujifilm_xtra_400, fujifilm_crystal_archive_typeii 5 4
-1.08361,
0.763734,
0.803178,
0.990345,
},
},
{
{ // fujifilm_c200 kodak_endura_premier, 6 0
-0.701783,
0.695052,
0.81012,
0.853376,
},
{ // fujifilm_c200 kodak_ektacolor_edge, 6 1
-0.643654,
0.606388,
0.788867,
0.896647,
},
{ // fujifilm_c200 kodak_supra_endura, 6 2
-0.465298,
0.532428,
0.912506,
0.892412,
},
{ // fujifilm_c200 kodak_portra_endura, 6 3
-0.699468,
0.444131,
0.855824,
0.881099,
},
{ // fujifilm_c200 fujifilm_crystal_archive_typeii 6 4
-1.13949,
0.761726,
0.813196,
0.994125,
},
},
};
