#pragma once
// the rest of this header is autogenerated by the following script:
#if 0
#!/bin/bash

films=(
kodak_portra_400,
kodak_ultramax_400,
kodak_gold_200,
kodak_vision3_50d,
fujifilm_pro_400h,
fujifilm_xtra_400,
fujifilm_c200
)

papers=(
kodak_endura_premier,
kodak_ektacolor_edge,
kodak_supra_endura,
kodak_portra_endura,
fujifilm_crystal_archive_typeii
)

n_films=${#films[@]}
n_papers=${#papers[@]}
# ${films[0]}

cat << EOF > neutral.cfg
frames:1
fps:0
module:const:main:23.3783:290.7
module:filmsim:01:255.558:326.7
module:display:main:719.252:340.033
module:pick:01:510.405:124.7
module:i-lut:filmsim:21.3333:441
module:i-lut:spectem:20:580.333
connect:const:main:output:filmsim:01:input
connect:i-lut:filmsim:output:filmsim:01:filmsim
connect:i-lut:spectem:output:filmsim:01:spectra
connect:filmsim:01:output:display:main:input
connect:filmsim:01:output:pick:01:input
param:const:main:nspots:1
param:const:main:colour:0.184:0.184:0.184:1
param:const:main:mode:0
param:const:main:wd:2
param:const:main:ht:2
param:pick:01:nspots:1
param:pick:01:spots:0:1:0:1
param:pick:01:ref:0.1774128:0.184:0.1518184
param:pick:01:show:2
param:pick:01:grab:1
param:pick:01:freeze:0
param:i-lut:filmsim:filename:data/filmsim.lut
param:i-lut:spectem:filename:data/spectra-em.lut
EOF

echo "// ev paper, filter c, filter m, filter y" > results.txt
echo "const float wb[$n_films][$n_papers][4] = {" >> results.txt
f=0
for film in ${films[@]}
do
  p=0
  echo "{" >> results.txt
  for paper in ${papers[@]}
  do
    echo $film $paper $f $p

    vkdt fit -d none -g neutral.cfg \
      --param "filmsim:01:filter c" \
      --param "filmsim:01:filter m" \
      --param "filmsim:01:filter y" \
      --param "filmsim:01:ev paper" \
      --target "pick:01:de76" --nelder-mead \
      --config "param:filmsim:01:film:$f" "param:filmsim:01:paper:$p" > neutral-opt.cfg
    echo "{ //" $film $paper $f $p >> results.txt
    echo $(cat neutral-opt.cfg | grep -E '^param:filmsim:01:ev paper' | cut -d: -f5), >> results.txt
    echo $(cat neutral-opt.cfg | grep -E '^param:filmsim:01:filter c' | cut -d: -f5), >> results.txt
    echo $(cat neutral-opt.cfg | grep -E '^param:filmsim:01:filter m' | cut -d: -f5), >> results.txt
    echo $(cat neutral-opt.cfg | grep -E '^param:filmsim:01:filter y' | cut -d: -f5), >> results.txt
    echo "}," >> results.txt
    p=$((p+1))
  done
  echo "}," >> results.txt
  f=$((f+1))
done
echo "};" >> results.txt
rm neutral-opt.cfg
#endif


// ev paper, filter c, filter m, filter y
const float wb[7][5][4] = {
{
{ // kodak_portra_400, kodak_endura_premier, 0 0
0.00699365,
0.396077,
0.529183,
0.574811,
},
{ // kodak_portra_400, kodak_ektacolor_edge, 0 1
0.087641,
0.052736,
0.483395,
0.676435,
},
{ // kodak_portra_400, kodak_supra_endura, 0 2
0.269684,
0.29932,
0.248754,
0.617898,
},
{ // kodak_portra_400, kodak_portra_endura, 0 3
0.313001,
0.309582,
0.215934,
0.654139,
},
{ // kodak_portra_400, fujifilm_crystal_archive_typeii 0 4
-0.200516,
0.306316,
0.620905,
0.833555,
},
},
{
{ // kodak_ultramax_400, kodak_endura_premier, 1 0
-0.123286,
0.354877,
0.563153,
0.525946,
},
{ // kodak_ultramax_400, kodak_ektacolor_edge, 1 1
0.239858,
0.142094,
0.592852,
0.695573,
},
{ // kodak_ultramax_400, kodak_supra_endura, 1 2
0.170887,
0.215829,
0.530179,
0.431472,
},
{ // kodak_ultramax_400, kodak_portra_endura, 1 3
0.142147,
0.191155,
0.488207,
0.460619,
},
{ // kodak_ultramax_400, fujifilm_crystal_archive_typeii 1 4
-0.240884,
0.301742,
0.661446,
0.834737,
},
},
{
{ // kodak_gold_200, kodak_endura_premier, 2 0
  // these are manual fits, the fitter diverged!
-1.0,
0.35,
0.61,
0.62,
},
{ // kodak_gold_200, kodak_ektacolor_edge, 2 1
-0.280617,
0.340392,
0.621981,
0.754127,
},
{ // kodak_gold_200, kodak_supra_endura, 2 2
-0.128867,
0.477608,
0.546256,
0.641303,
},
{ // kodak_gold_200, kodak_portra_endura, 2 3
-0.102635,
0.477539,
0.520916,
0.671371,
},
{ // kodak_gold_200, fujifilm_crystal_archive_typeii 2 4
-0.717953,
0.492752,
0.693373,
0.866559,
},
},
{
{ // kodak_vision3_50d, kodak_endura_premier, 3 0
-0.765306,
0.881921,
0.842748,
0.852113,
},
{ // kodak_vision3_50d, kodak_ektacolor_edge, 3 1
-0.314154,
0.835425,
0.845245,
0.898589,
},
{ // kodak_vision3_50d, kodak_supra_endura, 3 2
-1.22984,
0.732848,
0.617217,
0.709978,
},
{ // kodak_vision3_50d, kodak_portra_endura, 3 3
-1.41769,
0.6926,
0.556401,
0.69386,
},
{ // kodak_vision3_50d, fujifilm_crystal_archive_typeii 3 4
-2.11138,
0.811137,
0.732425,
0.838512,
},
},
{
{ // fujifilm_pro_400h, kodak_endura_premier, 4 0
-0.651918,
0.834284,
0.849318,
0.857086,
},
{ // fujifilm_pro_400h, kodak_ektacolor_edge, 4 1
-1.11418,
0.65586,
0.762971,
0.84092,
},
{ // fujifilm_pro_400h, kodak_supra_endura, 4 2
-0.511815,
0.755681,
0.733036,
0.791419,
},
{ // fujifilm_pro_400h, kodak_portra_endura, 4 3
-0.725746,
0.713532,
0.684352,
0.775558,
},
{ // fujifilm_pro_400h, fujifilm_crystal_archive_typeii 4 4
-0.803884,
0.826065,
0.860774,
0.911789,
},
},
{
{ // fujifilm_xtra_400, kodak_endura_premier, 5 0
-1.0678,
0.740945,
0.819096,
0.842749,
},
{ // fujifilm_xtra_400, kodak_ektacolor_edge, 5 1
-0.884338,
0.66984,
0.813851,
0.885717,
},
{ // fujifilm_xtra_400, kodak_supra_endura, 5 2
-0.616647,
0.677943,
0.758602,
0.82082,
},
{ // fujifilm_xtra_400, kodak_portra_endura, 5 3
-0.521949,
0.691088,
0.756911,
0.842784,
},
{ // fujifilm_xtra_400, fujifilm_crystal_archive_typeii 5 4
  // XXX this failed to fit, these are manual values:
-2.0,
0.61,
0.72,
0.83,
},
},
{
{ // fujifilm_c200 kodak_endura_premier, 6 0
  // XXX manual fit too:
  -1.0,
  0.60,
  0.78,
  0.88,
},
{ // fujifilm_c200 kodak_ektacolor_edge, 6 1
-0.74875,
0.591629,
0.815323,
0.907511,
},
{ // fujifilm_c200 kodak_supra_endura, 6 2
-0.747033,
0.566397,
0.704189,
0.837844,
},
{ // fujifilm_c200 kodak_portra_endura, 6 3
-0.776817,
0.549381,
0.683236,
0.845641,
},
{ // fujifilm_c200 fujifilm_crystal_archive_typeii 6 4
-0.283022,
0.848336,
0.919038,
0.969356,
},
},
};
