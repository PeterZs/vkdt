#pragma once
// the rest of this header is autogenerated by the following script:
#if 0
#!/bin/bash

films=(
kodak_portra_400,
kodak_ultramax_400,
kodak_gold_200,
kodak_vision3_50d,
fujifilm_pro_400h,
fujifilm_xtra_400,
fujifilm_c200
)

papers=(
kodak_endura_premier,
kodak_ektacolor_edge,
kodak_supra_endura,
kodak_portra_endura,
fujifilm_crystal_archive_typeii
)

n_films=${#films[@]}
n_papers=${#papers[@]}
# ${films[0]}

cat << EOF > neutral.cfg
frames:1
fps:0
module:const:main:23.3783:290.7
module:filmsim:01:255.558:326.7
module:display:main:719.252:340.033
module:pick:01:510.405:124.7
module:i-lut:filmsim:21.3333:441
module:i-lut:spectem:20:580.333
connect:const:main:output:filmsim:01:input
connect:i-lut:filmsim:output:filmsim:01:filmsim
connect:i-lut:spectem:output:filmsim:01:spectra
connect:filmsim:01:output:display:main:input
connect:filmsim:01:output:pick:01:input
param:const:main:nspots:1
param:const:main:colour:0.184:0.184:0.184:1
param:const:main:mode:0
param:pick:01:nspots:1
param:pick:01:spots:0:1:0:1
param:pick:01:ref:0.1774128:0.184:0.1518184
param:pick:01:show:2
param:pick:01:grab:1
param:pick:01:freeze:0
param:i-lut:filmsim:filename:data/filmsim.lut
param:i-lut:spectem:filename:data/spectra-em.lut
EOF

echo "// ev paper, filter c, filter m, filter y" > results.txt
echo "const float wb[$n_films][$n_papers][4] = {" >> results.txt
f=0
for film in ${films[@]}
do
  p=0
  echo "{" >> results.txt
  for paper in ${papers[@]}
  do
    echo $film $paper $f $p

    vkdt fit -d none -g neutral.cfg \
      --param "filmsim:01:filter c" \
      --param "filmsim:01:filter m" \
      --param "filmsim:01:filter y" \
      --param "filmsim:01:ev paper" \
      --target "pick:01:de76" --nelder-mead \
      --config "param:filmsim:01:film:$f" "param:filmsim:01:paper:$p" > neutral-opt.cfg
    echo "{ //" $film $paper $f $p >> results.txt
    echo $(cat neutral-opt.cfg | grep -E '^param:filmsim:01:ev paper' | cut -d: -f5), >> results.txt
    echo $(cat neutral-opt.cfg | grep -E '^param:filmsim:01:filter c' | cut -d: -f5), >> results.txt
    echo $(cat neutral-opt.cfg | grep -E '^param:filmsim:01:filter m' | cut -d: -f5), >> results.txt
    echo $(cat neutral-opt.cfg | grep -E '^param:filmsim:01:filter y' | cut -d: -f5), >> results.txt
    echo "}," >> results.txt
    p=$((p+1))
  done
  echo "}," >> results.txt
  f=$((f+1))
done
echo "};" >> results.txt
rm neutral-opt.cfg
#endif


// ev paper, filter c, filter m, filter y
const float wb[7][5][4] = {
{
{ // kodak_portra_400, kodak_endura_premier, 0 0
0.614114,
0.508619,
0.550195,
0.623775,
},
{ // kodak_portra_400, kodak_ektacolor_edge, 0 1
0.680346,
0.389405,
0.479983,
0.80774,
},
{ // kodak_portra_400, kodak_supra_endura, 0 2
0.664798,
0.231334,
0.296632,
0.907209,
},
{ // kodak_portra_400, kodak_portra_endura, 0 3
0.715715,
0.23802,
0.298188,
0.921476,
},
{ // kodak_portra_400, fujifilm_crystal_archive_typeii 0 4
0.221476,
0.621366,
0.580505,
0.923677,
},
},
{
{ // kodak_ultramax_400, kodak_endura_premier, 1 0
0.315104,
0.443207,
0.525336,
0.618386,
},
{ // kodak_ultramax_400, kodak_ektacolor_edge, 1 1
0.854701,
0.486739,
0.60765,
0.852963,
},
{ // kodak_ultramax_400, kodak_supra_endura, 1 2
0.593813,
0.203536,
0.460291,
0.911659,
},
{ // kodak_ultramax_400, kodak_portra_endura, 1 3
0.296482,
0.0505919,
0.283929,
0.895485,
},
{ // kodak_ultramax_400, fujifilm_crystal_archive_typeii 1 4
0.164698,
0.641635,
0.626101,
0.936507,
},
},
{
{ // kodak_gold_200, kodak_endura_premier, 2 0
0.1571,
0.671915,
0.65687,
0.698579,
},
{ // kodak_gold_200, kodak_ektacolor_edge, 2 1
0.268337,
0.614301,
0.620635,
0.825731,
},
{ // kodak_gold_200, kodak_supra_endura, 2 2
0.262454,
0.44618,
0.635239,
0.878259,
},
{ // kodak_gold_200, kodak_portra_endura, 2 3
0.192004,
0.410668,
0.589684,
0.882212,
},
{ // kodak_gold_200, fujifilm_crystal_archive_typeii 2 4
-0.143203,
0.783644,
0.699621,
0.957084,
},
},
{
{ // kodak_vision3_50d, kodak_endura_premier, 3 0
-0.277167,
0.869367,
0.864148,
0.880999,
},
{ // kodak_vision3_50d, kodak_ektacolor_edge, 3 1
-0.283181,
0.818245,
0.83918,
0.913499,
},
{ // kodak_vision3_50d, kodak_supra_endura, 3 2
-0.207807,
0.778074,
0.906392,
0.923458,
},
{ // kodak_vision3_50d, kodak_portra_endura, 3 3
-0.266854,
0.763722,
0.88579,
0.925964,
},
{ // kodak_vision3_50d, fujifilm_crystal_archive_typeii 3 4
-0.67617,
0.895677,
0.875405,
1.04588,
},
},
{
{ // fujifilm_pro_400h, kodak_endura_premier, 4 0
-0.309592,
0.808694,
0.851723,
0.850879,
},
{ // fujifilm_pro_400h, kodak_ektacolor_edge, 4 1
-0.0940791,
0.773614,
0.852663,
0.909619,
},
{ // fujifilm_pro_400h, kodak_supra_endura, 4 2
-0.168865,
0.692385,
0.907503,
0.89026,
},
{ // fujifilm_pro_400h, kodak_portra_endura, 4 3
-0.185853,
0.681563,
0.894237,
0.89765,
},
{ // fujifilm_pro_400h, fujifilm_crystal_archive_typeii 4 4
-0.501632,
0.872495,
0.883784,
1.05841,
},
},
{
{ // fujifilm_xtra_400, kodak_endura_premier, 5 0
-0.220742,
0.763872,
0.865921,
0.887606,
},
{ // fujifilm_xtra_400, kodak_ektacolor_edge, 5 1
0.0232313,
0.725635,
0.873145,
0.933684,
},
{ // fujifilm_xtra_400, kodak_supra_endura, 5 2
-0.157602,
0.595669,
0.948959,
0.923847,
},
{ // fujifilm_xtra_400, kodak_portra_endura, 5 3
-0.126468,
0.594268,
0.945873,
0.931845,
},
{ // fujifilm_xtra_400, fujifilm_crystal_archive_typeii 5 4
-0.168834,
0.817318,
0.89439,
0.783185,
},
},
{
{ // fujifilm_c200 kodak_endura_premier, 6 0
-0.173722,
0.746974,
0.8738,
0.897048,
},
{ // fujifilm_c200 kodak_ektacolor_edge, 6 1
-0.309631,
0.627886,
0.834842,
0.917717,
},
{ // fujifilm_c200 kodak_supra_endura, 6 2
-0.134129,
0.556647,
0.962542,
0.91487,
},
{ // fujifilm_c200 kodak_portra_endura, 6 3
-0.139619,
0.544406,
0.95332,
0.921447,
},
{ // fujifilm_c200 fujifilm_crystal_archive_typeii 6 4
-0.17226,
0.808869,
0.896635,
0.797628,
},
},
};
